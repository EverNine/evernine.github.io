

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tunning &mdash; Worry&#39;s Wiki  文档</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="索引"
              href="../genindex.html"/>
        <link rel="search" title="搜索" href="../search.html"/>
    <link rel="top" title="Worry&#39;s Wiki  文档" href="../index.html"/>
        <link rel="up" title="Ops" href="index.html"/>
        <link rel="next" title="Benchmark" href="benchmark/index.html"/>
        <link rel="prev" title="Ops" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Worry's Wiki
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Ops</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tunning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">方法论</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">文档化</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">度量目标</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">建立基线</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">选择工具</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">验证你的工具</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">了解你的系统</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">深入你的系统</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">修改你的系统</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">调优过程</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id11">建立调优流程</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">自动化</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">性能测量误区</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id14">工具</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id15">测量工具误区</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16">日志</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17">图表</a></li>
<li class="toctree-l4"><a class="reference internal" href="#profiling">Profiling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tracing">Tracing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="benchmark/index.html">Benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="profile/index.html">Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="trace/index.html">Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="subsystem_tunning/index.html">Subsystem Tunning</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../version_control/git.html">git</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Worry's Wiki</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Ops</a> &raquo;</li>
        
      <li>Tunning</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ops/tunning.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tunning">
<h1>Tunning<a class="headerlink" href="#tunning" title="永久链接至标题">¶</a></h1>
<div class="section" id="id1">
<h2>方法论<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<div class="section" id="id2">
<h3>文档化<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>记录你所调谐的系统的相关信息</li>
<li>在你干涉系统后随时同步更新你的记录</li>
<li>在迭代过程中持续跟踪所有的变化量<ul>
<li>硬件设备、可调谐设置、软件等</li>
<li>给所有变化打上时间戳</li>
<li>要能确保你只改变了整个系统的一方面</li>
</ul>
</li>
<li>好记性不如烂笔头</li>
</ul>
</div>
<div class="section" id="id3">
<h3>度量目标<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>明确你要以什么指标来衡量性能
+ 响应时间
+ CPU占用率
+ 内存占用率
+ 任务处理速度
+ 其他</li>
<li>聚焦在单一指标上，但同时需要观察其他指标
+ 对某一指标的优化会影响其他指标</li>
<li>自动化你的度量系统
+ 尽可能地将衡量性能指标的过程傻瓜化</li>
</ul>
</div>
<div class="section" id="id4">
<h3>建立基线<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>理解wire speed</li>
<li>从一个干净的系统开始
+ 测试前重启系统、清空cache</li>
<li>不要在有业务负载的环境进行测试</li>
<li>不要过早地对系统进行修改</li>
<li>理解环境信息与测试结果
+ 性能数据的解读结果取决于解读他的人</li>
</ul>
</div>
<div class="section" id="id5">
<h3>选择工具<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>可用性是工具选择的第一关注点
+ 老版本Linux内核缺少部分子系统
+ 部分内核版本没有集成一些工具
+ 不要把时间花在工具上而不是实际的问题上</li>
</ul>
</div>
<div class="section" id="id6">
<h3>验证你的工具<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>工具是否满足商用要求？
+ 关注工具的可靠性与稳定性
+ 定义不可用的标准</li>
<li>引入的杂音
+ 是否会引入不可接受的额外负载</li>
<li>能否与其他工具共存</li>
</ul>
</div>
<div class="section" id="id7">
<h3>了解你的系统<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>明确性能瓶颈
+ 从通用的工具开始
+ 善用Profile工具</li>
<li>花时间去了解更多细节
+ 内核行为
+ 硬件架构
+ CPU能力</li>
</ul>
</div>
<div class="section" id="id8">
<h3>深入你的系统<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>使用更加精确的工具进行测量</li>
<li>使用instrumentation工具观察软件的内部
+ Systemtap
+ gdb
+ 要求开发者修改代码使其可读</li>
<li>用trace工具增加观测结果的可靠性
- ftrace
- strace
- ltrace</li>
</ul>
</div>
<div class="section" id="id9">
<h3>修改你的系统<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>根据上一个测试周期的结果决定要修改什么</li>
<li>确保你在一个稳定版本上进行修改
+ 性能调优应是开发环节的最后一步</li>
<li>不要试错</li>
<li>一次修改一个元素</li>
<li>考虑副作用
+ 是否增加了资源占用
+ 是否影响了其他测量指标</li>
</ul>
</div>
</div>
<div class="section" id="id10">
<h2>调优过程<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h2>
<div class="section" id="id11">
<h3>建立调优流程<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>记录当前系统的状态与测试结果</li>
<li>建立假设并预测结果</li>
<li>修改系统</li>
<li>观察、评估结果</li>
<li>重复以上步骤</li>
</ul>
</div>
<div class="section" id="id12">
<h3>自动化<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>将重点放在可重复性与自动化上
+ 让调优过程更加人性化
+ 微小的改进总是能带来巨大的收益</li>
<li>在调优过程中引入变更管理</li>
</ul>
</div>
<div class="section" id="id13">
<h3>性能测量误区<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>不要为了测量性能指标而变更你的系统</li>
<li>应以在不影响性能的情况下测量性能为目标
+ 牢记海森堡测不准原理</li>
<li>通用规则：越高的测量频率会引入越高的额外负载
+ 在测量精度与额外负载间进行权衡</li>
</ul>
</div>
</div>
<div class="section" id="id14">
<h2>工具<a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h2>
<div class="section" id="id15">
<h3>测量工具误区<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>理解你使用的工具做了什么</li>
<li>一些操作可能会影响整体的性能
+ 插入调试代码
+ 监控特定的场景
+ 将性能数据写入磁盘</li>
<li>工具会说谎：如果可能的话，与第二次结果进行比较</li>
<li>记录工具的结果与单位</li>
<li>不要生产你不需要的数据</li>
<li>Little&#8217;s Law</li>
</ul>
</div>
<div class="section" id="id16">
<h3>日志<a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h3>
</div>
<div class="section" id="id17">
<h3>图表<a class="headerlink" href="#id17" title="永久链接至标题">¶</a></h3>
</div>
<div class="section" id="profiling">
<h3>Profiling<a class="headerlink" href="#profiling" title="永久链接至标题">¶</a></h3>
</div>
<div class="section" id="tracing">
<h3>Tracing<a class="headerlink" href="#tracing" title="永久链接至标题">¶</a></h3>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="benchmark/index.html" class="btn btn-neutral float-right" title="Benchmark" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Ops" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Worry.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>